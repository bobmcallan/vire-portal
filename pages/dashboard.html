<!DOCTYPE html>
<html lang="en">

<head>
    {{template "head.html" .}}
    <title>VIRE DASHBOARD</title>
</head>

<body>

    {{if .LoggedIn}}{{template "nav.html" .}}{{end}}

    <main class="dashboard">
        <div class="dashboard-inner">

            {{if .NavexaKeyMissing}}
            <div class="warning-banner">
                <strong>WARNING:</strong> Navexa API key not configured.
                <a href="/settings">Set your API key in Settings</a> to enable portfolio sync.
            </div>
            {{end}}

            <section class="dashboard-section">
                <h2 class="section-title">MCP CONNECTION</h2>
                <div class="config-block">
                    <p>Endpoint: <code>{{.MCPEndpoint}}</code></p>
                    <p>Add to your Claude Code config:</p>
                    <pre><code>{
  "mcpServers": {
    "vire": {
      "type": "streamable-http",
      "url": "http://localhost:{{.Port}}/mcp"
    }
  }
}</code></pre>
                </div>
                {{if .DevMCPEndpoint}}
                <div class="config-block" style="margin-top: 1rem; border-left: 3px solid #f59e0b; padding-left: 1rem;">
                    <p><strong>DEV MODE:</strong> Authenticated endpoint (Claude Desktop):</p>
                    <p><code style="word-break: break-all;">{{.DevMCPEndpoint}}</code></p>
                    <p class="hint">Use this URL in Claude Desktop config. It authenticates as your user.</p>
                </div>
                {{end}}
            </section>

            <section class="dashboard-section">
                <h2 class="section-title">CONFIG</h2>
                <div class="config-block">
                    <p>Portfolios: {{if .Config.Portfolios}}{{.Config.Portfolios}}{{else}}(none){{end}}</p>
                </div>
            </section>

            <section class="dashboard-section">
                <h2 class="section-title">TOOLS [{{.ToolStatus}}]</h2>
                {{if .Tools}}
                <div class="table-wrap">
                    <table class="tool-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Description</th>
                                <th>Method</th>
                                <th>Path</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{range .Tools}}
                            <tr>
                                <td class="tool-name">{{.Name}}</td>
                                <td class="tool-desc">{{.Description}}</td>
                                <td class="tool-method">{{.Method}}</td>
                                <td class="tool-path">{{.Path}}</td>
                            </tr>
                            {{end}}
                        </tbody>
                    </table>
                </div>
                {{else}}
                <p class="no-tools">NO TOOLS available. Ensure vire-server is running.</p>
                {{end}}
            </section>

        </div>
    </main>

    {{template "footer.html" .}}

</body>

</html>
